GOOGLE SHEETS SYNC & RECEIPT GENERATION GUIDE
==============================================

OVERVIEW
--------
Your system now has a complete workflow:

1. Add payments in Google Sheets
2. Sync to Excel (offline backup)
3. Generate receipts (PDF + Web)
4. Recipients see payments on web portal

HOW TO USE
----------

OPTION 1: Quick Sync Batch File (EASIEST)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Double-click: SYNC_AND_EXPORT.bat
2. Wait for completion
3. PDFs automatically generated
4. Excel updated with latest data

OPTION 2: Python Script
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
cd "d:\Payment recept"
python sync_and_export.py

OPTION 3: Manual Steps
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Step A - Update Excel from Google Sheets:
  python sync_google_sheet.py

Step B - Generate Receipts:
  python export_receipt.py
  (or: python generate_receipts.py)


WORKFLOW EXPLANATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Google Sheets      â”‚
â”‚  (Add payments)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sync Google Sheets  â”‚
â”‚  sync_google_sheet  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Excel Updated       â”‚
â”‚ (Offline backup)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Generate Receipts   â”‚
â”‚ generate_receipts   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
     â†“           â†“
  PDF Files   JSON Data
     â†“           â†“
 receipts/  receipts/data/
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Web Portal         â”‚
â”‚  Shows all payments â”‚
â”‚  (Deployed online)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


WHAT SYNCS FROM GOOGLE SHEETS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Google Sheets can contain per-recipient sections:
  [Recipient: john@email.com]
  Receipt No | Amount | Due | Date | Description
  2001       | Â¥5000  | Â¥0   | ...  | Service
  2002       | Â¥3000  | Â¥500 | ...  | Payment

When you sync:
âœ“ Data updates in recipients_data.xlsx
âœ“ Receipts generate for new entries
âœ“ Web portal shows all payments
âœ“ Payment status auto-calculated


KEY FILES
â”€â”€â”€â”€â”€â”€â”€â”€

1. sync_google_sheet.py
   - Fetches data from Google Sheets
   - Updates recipients_data.xlsx
   - Only syncs if data changed

2. generate_receipts.py
   - Reads from recipients_data.xlsx
   - Creates PDF receipts
   - Generates JSON data for web portal

3. receipts_data.xlsx
   - LOCAL backup of payment data
   - Used by Python to generate receipts
   - NEVER overwritten by web portal

4. recipients.xlsm
   - Macro workbook with export button
   - Click button to export individual receipt
   - Independent from data sync


AUTOMATION TIPS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Schedule automatic syncs:
- Windows Task Scheduler: Schedule SYNC_AND_EXPORT.bat hourly
- Python: Create cron job (Linux/Mac)

Or run manually each time you add payments to Google Sheets.


TROUBLESHOOTING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Q: Excel not updating?
A: Check if Google Sheets data changed. Sync only updates if data is new.

Q: PDFs showing wrong payment status?
A: Make sure Amount and Due Amount columns are correct in Excel.

Q: Web portal not showing new receipts?
A: 1. Run sync_and_export.py
   2. Push to GitHub (git push)
   3. Wait 1-2 minutes for GitHub Pages to update
   4. Hard refresh browser (Ctrl+F5)

Q: Can I edit Excel directly?
A: Yes! Just run generate_receipts.py after editing to update PDFs.

Q: Auto-sync shows 401 errors?
A: Your Google Apps Script web app is not public.
  Fix:
  1. Open your Apps Script project
  2. Deploy â†’ Manage deployments â†’ Edit
  3. Execute as: Me
  4. Who has access: Anyone
  5. Save and update the URL if it changes


SUMMARY
â”€â”€â”€â”€â”€â”€â”€

Your complete payment system:

LOCAL:
  âœ“ Excel for data entry (recipients_data.xlsx)
  âœ“ Button to export individual receipts (recipients.xlsm)
  âœ“ Python scripts for automation

CLOUD:
  âœ“ Google Sheets for team collaboration
  âœ“ GitHub for version control
  âœ“ GitHub Pages for web portal

SYNC:
  âœ“ Bidirectional when online (Google Sheets â†” Excel)
  âœ“ Offline backup in Excel
  âœ“ Online dashboard for recipients

Ready to go! ğŸš€
