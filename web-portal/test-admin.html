<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin JS Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
        .test-box { background: white; padding: 20px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .success { color: #2ecc71; }
        .error { color: #e74c3c; }
        button { padding: 10px 20px; margin: 5px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #5568d3; }
    </style>
</head>
<body>
    <h1>Admin JavaScript Validation Test</h1>
    
    <div class="test-box">
        <h2>JavaScript Loading Test</h2>
        <p id="jsStatus">⏳ Checking...</p>
    </div>

    <div class="test-box">
        <h2>Function Tests</h2>
        <button onclick="testValidation()">Test Email Validation</button>
        <button onclick="testSanitization()">Test Input Sanitization</button>
        <button onclick="testAmountValidation()">Test Amount Validation</button>
        <p id="testResults"></p>
    </div>

    <div class="test-box">
        <h2>Console Errors</h2>
        <p class="error">Check browser console (F12) for any errors</p>
        <button onclick="showConsoleInstructions()">How to Check Console</button>
        <div id="instructions" style="display:none; margin-top:10px; padding:10px; background:#f8f8f8; border-left:4px solid #667eea;">
            <strong>To check console:</strong>
            <ol>
                <li>Press <strong>F12</strong> or <strong>Ctrl+Shift+I</strong> (Windows) / <strong>Cmd+Option+I</strong> (Mac)</li>
                <li>Click on the <strong>Console</strong> tab</li>
                <li>Look for red error messages</li>
                <li>Copy any errors and send them</li>
            </ol>
        </div>
    </div>

    <div class="test-box">
        <h2>Admin Page Test</h2>
        <button onclick="window.location.href='admin.html'">Go to Admin Dashboard</button>
    </div>

    <script src="auth.js"></script>
    <script src="admin.js"></script>
    <script>
        // Check if admin.js loaded successfully
        window.addEventListener('DOMContentLoaded', () => {
            const statusEl = document.getElementById('jsStatus');
            
            try {
                // Check if key functions exist
                const functionsExist = typeof sanitizeInput === 'function' && 
                                      typeof isValidEmail === 'function' && 
                                      typeof isValidAmount === 'function';
                
                if (functionsExist) {
                    statusEl.innerHTML = '<span class="success">✅ admin.js loaded successfully! All functions found.</span>';
                } else {
                    statusEl.innerHTML = '<span class="error">❌ admin.js loaded but some functions are missing</span>';
                }
            } catch (error) {
                statusEl.innerHTML = '<span class="error">❌ Error loading admin.js: ' + error.message + '</span>';
            }
        });

        function testValidation() {
            const results = document.getElementById('testResults');
            try {
                const test1 = isValidEmail('test@example.com') === true;
                const test2 = isValidEmail('invalid-email') === false;
                
                if (test1 && test2) {
                    results.innerHTML = '<span class="success">✅ Email validation working!</span>';
                } else {
                    results.innerHTML = '<span class="error">❌ Email validation failed</span>';
                }
            } catch (error) {
                results.innerHTML = '<span class="error">❌ Error: ' + error.message + '</span>';
            }
        }

        function testSanitization() {
            const results = document.getElementById('testResults');
            try {
                const input = '<script>alert("test")</script>';
                const sanitized = sanitizeInput(input);
                
                if (sanitized.includes('&lt;') && sanitized.includes('&gt;')) {
                    results.innerHTML = '<span class="success">✅ Input sanitization working!</span>';
                } else {
                    results.innerHTML = '<span class="error">❌ Sanitization failed</span>';
                }
            } catch (error) {
                results.innerHTML = '<span class="error">❌ Error: ' + error.message + '</span>';
            }
        }

        function testAmountValidation() {
            const results = document.getElementById('testResults');
            try {
                const test1 = isValidAmount('100') === true;
                const test2 = isValidAmount('abc') === false;
                const test3 = isValidAmount('-50') === false;
                
                if (test1 && test2 && test3) {
                    results.innerHTML = '<span class="success">✅ Amount validation working!</span>';
                } else {
                    results.innerHTML = '<span class="error">❌ Amount validation failed</span>';
                }
            } catch (error) {
                results.innerHTML = '<span class="error">❌ Error: ' + error.message + '</span>';
            }
        }

        function showConsoleInstructions() {
            const instructions = document.getElementById('instructions');
            instructions.style.display = instructions.style.display === 'none' ? 'block' : 'none';
        }
    </script>
</body>
</html>
